// NOT WORKING YET

// Use a single settings list to generate multiple templated nodes
// "tags" in settings list control which items appear in which template

MY_SETTINGS
{
  TEMPLIST
  {
    Experiment
    {
      name = crewReport
      TAG_isCrewExp = true
    }
    Experiment
    {
      name = healthExperiments
      TAG_isCrewExp = true
    }
    Experiment
    {
      name = temperatureScan
      TAG_isUnmannedExp = true
    }
    Experiment
    {
      name = barometerScan
      TAG_isUnmannedExp = true
    }
  }
  // container for output
  OUTPUT_TEMPLATES
  {
    CREW {}
    UNMANNED {}
  }
}

// Do processing
@MY_SETTINGS:HAS[@TEMPLIST:HAS[@Experiment[#TAG_isCrewExp[?rue]]]]:FOR[ZZZZZZZZZ_Templating]
{
    @OUTPUT_TEMPLATES
    {
      @CREW
      {
        EXPERIMENT_TEMPLATE
        {
          name = Experiment
          experiment_id = #$/TEMPLIST/Experiment:HAS[#TAG_isCrewExp[?rue]]/name$
        }
      }
    }

    @TEMPLIST
    {
      !Experiment:HAS[#TAG_isCrewExp[?rue]],0 {}
    }

    MM_PATCH_LOOP {}
}
